# Story 2.2: Course Material Upload and Organization

## Status
Draft

## Story
**As a** lecturer,
**I want to** upload and organize course materials,
**so that** students can access learning resources

## Acceptance Criteria
1. Lecturer can upload files (PDFs, documents, videos)
2. Materials can be organized into folders/modules
3. Materials can be reordered and renamed
4. File size and type restrictions are enforced
5. Materials have proper access controls

## Tasks / Subtasks
- [ ] Implement file upload system (AC: 1, 4)
  - [ ] Create drag-and-drop file upload interface
  - [ ] Add file type validation (PDF, DOC, DOCX, PPT, MP4, etc.)
  - [ ] Implement file size validation (optimized for 1GB Supabase limit)
  - [ ] Add file compression for images and videos
  - [ ] Create upload progress indicators and error handling
- [ ] Build material organization system (AC: 2)
  - [ ] Create folder/module structure for course materials
  - [ ] Implement nested folder functionality
  - [ ] Add drag-and-drop organization interface
  - [ ] Create module templates (Week 1, Lecture 1, etc.)
- [ ] Add material management features (AC: 3)
  - [ ] Implement file renaming functionality
  - [ ] Add material reordering (drag-and-drop)
  - [ ] Create bulk material operations (move, delete, rename)
  - [ ] Add material preview functionality
- [ ] Create access control system (AC: 5)
  - [ ] Implement material visibility settings (public, enrolled students only)
  - [ ] Add material access logging for analytics
  - [ ] Create material download restrictions if needed
  - [ ] Ensure only course lecturers can modify materials
- [ ] Build material viewing interface (AC: 1, 2)
  - [ ] Create responsive material browser with folder view
  - [ ] Add material search and filtering
  - [ ] Implement material thumbnail generation
  - [ ] Add material metadata display (size, type, upload date)
- [ ] Optimize for free tier storage (AC: 4)
  - [ ] Implement smart file compression strategies
  - [ ] Add storage usage tracking per course
  - [ ] Create storage limit warnings and recommendations
  - [ ] Add material archiving/cleanup features

## Dev Notes

### Previous Story Context
This story builds on completed stories:
- **Story 1.1-1.3**: Complete authentication and user management system
- **Story 2.1**: Course creation and basic setup established
- **Dependencies**: Requires existing course structure and lecturer authentication

### Technical Stack Context - Free Tier Optimized
[Source: docs/prd/technical-stack.md]
- **Frontend**: Next.js, Tailwind CSS
- **Backend**: Supabase (Free Tier - 500MB database, 2GB bandwidth)
- **File Storage**: Supabase Storage (Free Tier: 1GB total - CRITICAL CONSTRAINT)
- **Database**: PostgreSQL via Supabase for material metadata
- **Hosting**: Vercel (Free Tier)

### Free Tier Storage Strategy
**1GB Total Storage Allocation:**
- **User Avatars**: ~100MB (estimated 2,000 users √ó 50KB average)
- **Course Materials**: ~800MB (primary content storage)
- **Course Thumbnails**: ~100MB (course branding/images)

**File Size Limits (Free Tier Optimized):**
- **Documents (PDF, DOC)**: Max 10MB per file
- **Images**: Max 2MB per file (with compression)
- **Videos**: Max 50MB per file (strong compression recommended)
- **Presentations**: Max 15MB per file

### Data Models Extension
Extended database schema for materials:
```sql
CREATE TABLE course_materials (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  course_id UUID REFERENCES courses(id) ON DELETE CASCADE,
  name VARCHAR(255) NOT NULL,
  original_filename VARCHAR(255) NOT NULL,
  file_type VARCHAR(50) NOT NULL,
  file_size INTEGER NOT NULL,
  storage_path TEXT NOT NULL, -- Supabase storage path
  folder_path TEXT DEFAULT '', -- Virtual folder organization
  display_order INTEGER DEFAULT 0,
  visibility VARCHAR(20) DEFAULT 'enrolled', -- 'public', 'enrolled', 'hidden'
  uploaded_by UUID REFERENCES users(id),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE course_folders (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  course_id UUID REFERENCES courses(id) ON DELETE CASCADE,
  name VARCHAR(255) NOT NULL,
  parent_folder_id UUID REFERENCES course_folders(id),
  display_order INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### File Locations
Based on Next.js conventions and storage optimization:
- Material pages: `pages/courses/[id]/materials/` or `app/courses/[id]/materials/`
- Upload components: `components/materials/FileUpload.js`, `components/materials/MaterialBrowser.js`
- Material utilities: `lib/materials.js`, `lib/fileProcessing.js`
- Storage helpers: `utils/storageOptimization.js`
- Material hooks: `hooks/useMaterials.js`, `hooks/useFileUpload.js`

### File Processing Pipeline (Free Tier Optimized)
```javascript
// Optimized file processing for 1GB limit
1. Client-side file validation (type, size)
2. Image compression (reduce to 80% quality, max 1920px width)
3. Video compression warning (recommend external hosting for large videos)
4. Duplicate file detection (prevent redundant uploads)
5. Supabase Storage upload with progress tracking
6. Database metadata storage
7. Cache invalidation for material lists
```

### Storage Optimization Strategies
- **Image Compression**: Automatic compression to maintain quality under size limits
- **Video Handling**: Recommend YouTube/Vimeo embedding for large videos
- **Duplicate Detection**: Prevent multiple uploads of identical files
- **File Cleanup**: Automatic cleanup of orphaned files
- **Compression Recommendations**: Guide users to compress large files before upload
- **External Links**: Option to link to external resources instead of uploading

### Supabase Storage Structure
```
/courses/
  /{course-id}/
    /materials/
      /{material-id}-{filename}
    /thumbnails/
      /course-thumb.jpg
```

### Technical Requirements - Free Tier Focused
- **Smart Upload Limits**: Dynamic file size limits based on remaining storage
- **Compression Integration**: Automatic image optimization before upload
- **Progress Tracking**: Real-time upload progress with cancel functionality
- **Error Recovery**: Retry mechanisms for failed uploads
- **Storage Monitoring**: Track and display storage usage per course
- **File Validation**: Comprehensive client and server-side validation

### User Experience Features
- **Drag-and-Drop**: Intuitive file organization
- **Bulk Operations**: Multiple file handling for efficiency
- **Preview System**: Quick material preview without downloading
- **Search & Filter**: Easy material discovery
- **Mobile Support**: Responsive design for mobile material access
- **Offline Indication**: Show when files are available offline (future PWA feature)

### Security Considerations
- **Access Control**: Material access based on course enrollment
- **File Scanning**: Basic file type validation to prevent malicious uploads
- **Lecturer Ownership**: Only course lecturers can upload/modify materials
- **Storage Quotas**: Per-course storage limits to prevent abuse
- **Download Logging**: Track material access for analytics

### Performance Optimizations
- **Lazy Loading**: Load materials on demand
- **Thumbnail Generation**: Create thumbnails for better UX
- **CDN Utilization**: Leverage Supabase CDN for faster delivery
- **Caching Strategy**: Cache material lists and metadata
- **Efficient Queries**: Optimize database queries for material retrieval

### Testing
Material management requires thorough testing:
- **Upload Tests**: File upload, validation, compression
- **Organization Tests**: Folder creation, material organization
- **Access Control Tests**: Permission verification, enrollment checks
- **Storage Tests**: Free tier limit handling, cleanup processes
- **Performance Tests**: Large file handling, batch operations

## Testing

### Testing Standards
Course material management testing strategy:
- **Unit Tests**:
  - File validation functions (`utils/fileValidation.test.js`)
  - File compression utilities (`lib/fileProcessing.test.js`)
  - Storage optimization logic (`utils/storageOptimization.test.js`)
- **Component Tests**:
  - File upload interface with drag-and-drop
  - Material browser and organization features
  - File preview and management components
- **Integration Tests**:
  - Supabase Storage integration (`api/materials.test.js`)
  - File upload and compression pipeline
  - Material access control verification
- **E2E Tests**:
  - Complete material upload workflow
  - Material organization and management
  - Student material access verification
- **Storage Tests**:
  - Free tier limit handling and warnings
  - File cleanup and optimization processes
  - Storage quota enforcement

Test file locations:
- `__tests__/materials/materialComponents.test.js`
- `__tests__/api/materialsApi.test.js`
- `__tests__/e2e/materialManagement.test.js`
- `__tests__/storage/storageOptimization.test.js`

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-07-21 | 1.0 | Initial story creation with free tier storage optimization | Scrum Master (Bob) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results

### üß™ Senior QA Review - Story 2.2: Course Material Upload and Organization
**Reviewed by:** Quinn (Senior Developer & QA Architect)  
**Review Date:** July 21, 2025  
**Review Type:** File Management Security & Free Tier Optimization Assessment

#### üìã **Overall Assessment: EXCELLENT FREE TIER ENGINEERING WITH SECURITY GAPS** ‚≠ê‚≠ê‚≠ê‚≠ê‚ö†Ô∏è
This story shows outstanding free tier optimization and storage management thinking. However, critical file security vulnerabilities must be addressed before implementation.

---

#### ‚úÖ **Outstanding Strengths**

**1. Exceptional Free Tier Storage Engineering**
- ‚úÖ **Resource Allocation Strategy**: Brilliant 1GB breakdown (800MB materials, 100MB avatars, 100MB thumbnails)
- ‚úÖ **Smart File Size Limits**: Dynamic limits based on remaining storage
- ‚úÖ **Compression Pipeline**: Automatic image optimization and video handling recommendations
- ‚úÖ **Storage Monitoring**: Real-time usage tracking and warnings

**2. Sophisticated File Management Architecture**
- ‚úÖ **Hierarchical Organization**: Proper folder/module structure with nested support
- ‚úÖ **Database Design**: Clean separation of file metadata and storage paths
- ‚úÖ **User Experience**: Drag-and-drop interface with bulk operations
- ‚úÖ **Performance Optimization**: Lazy loading and thumbnail generation

**3. Comprehensive Technical Planning**
- ‚úÖ **File Processing Pipeline**: Well-thought-out compression and validation flow
- ‚úÖ **Storage Structure**: Logical Supabase storage organization
- ‚úÖ **Integration Readiness**: Builds properly on course creation (Story 2.1)

---

#### ‚ö†Ô∏è **CRITICAL SECURITY VULNERABILITIES**

**1. Insufficient File Security Controls**
```javascript
// CURRENT: Basic file type validation
fileTypes: ['PDF', 'DOC', 'DOCX', 'PPT', 'MP4']

// REQUIRED: Comprehensive file security system
const fileSecurityControls = {
  uploadSecurity: {
    fileTypeValidation: {
      allowedMimeTypes: {
        documents: ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'],
        presentations: ['application/vnd.ms-powerpoint', 'application/vnd.openxmlformats-officedocument.presentationml.presentation'],
        images: ['image/jpeg', 'image/png', 'image/webp'],
        videos: ['video/mp4', 'video/webm'] // Restrict codecs
      },
      headerValidation: 'Verify file headers match declared MIME type',
      extensionWhitelist: 'Strict extension validation',
      doubleExtensionPrevention: 'Block files like "malware.pdf.exe"'
    },
    
    malwareProtection: {
      virusScanning: 'Integrate with virus scanning service',
      quarantineUploads: 'Hold uploads for security review',
      hashChecking: 'Check against known malware signatures',
      sandboxExecution: 'Safe file preview generation'
    },
    
    contentValidation: {
      pdfSecurity: 'Scan PDFs for embedded malware',
      officeDocuments: 'Validate Office documents for macros',
      imageMetadata: 'Strip potentially malicious EXIF data',
      videoCodecs: 'Validate video codecs and containers'
    }
  },
  
  accessSecurity: {
    authentication: 'Verify user authentication for all file operations',
    authorization: 'Course-level access control for materials',
    tokenValidation: 'Secure file access tokens with expiration',
    downloadLogging: 'Log all file access for audit purposes'
  }
};
```

**2. Missing Educational Content Protection**
```javascript
// CRITICAL GAP: No educational content protection
// REQUIRED: Educational material security
const educationalContentSecurity = {
  intellectualProperty: {
    copyrightProtection: 'Watermark uploaded materials with course/institution info',
    dmcaCompliance: 'Takedown process for copyright violations',
    licenseTracking: 'Track license agreements for uploaded content',
    usageRestrictions: 'Enforce educational use only restrictions'
  },
  
  studentDataProtection: {
    ferpaCompliance: 'Ensure materials don\'t expose student information',
    anonymization: 'Strip personal information from shared materials',
    consentTracking: 'Track consent for material sharing',
    dataRetention: 'Automatic cleanup of outdated educational materials'
  },
  
  institutionalSecurity: {
    contentModeration: 'Review materials for inappropriate content',
    institutionalPolicies: 'Enforce institutional content policies',
    backupStrategy: 'Secure backup of educational materials',
    disasterRecovery: 'Recovery procedures for lost educational content'
  }
};
```

**3. Inadequate Storage Security Architecture**
```sql
-- REQUIRED: Enhanced security schema for materials
CREATE TABLE course_materials (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  course_id UUID REFERENCES courses(id) ON DELETE CASCADE,
  name VARCHAR(255) NOT NULL,
  original_filename VARCHAR(255) NOT NULL,
  
  -- Enhanced file security metadata
  file_type VARCHAR(50) NOT NULL,
  mime_type VARCHAR(100) NOT NULL,
  file_size INTEGER NOT NULL,
  file_hash VARCHAR(64) NOT NULL, -- SHA-256 for duplicate detection and integrity
  virus_scan_status VARCHAR(20) DEFAULT 'pending', -- pending, clean, infected, error
  virus_scan_date TIMESTAMP,
  
  -- Storage and access control
  storage_path TEXT NOT NULL,
  storage_bucket VARCHAR(100) NOT NULL,
  encryption_key_id UUID, -- For encrypted storage
  access_token VARCHAR(255), -- Secure access token
  token_expires_at TIMESTAMP,
  
  -- Organization and display
  folder_path TEXT DEFAULT '',
  display_order INTEGER DEFAULT 0,
  
  -- Access control and privacy
  visibility VARCHAR(20) DEFAULT 'enrolled' CHECK (visibility IN ('public', 'enrolled', 'hidden', 'restricted')),
  download_allowed BOOLEAN DEFAULT true,
  offline_allowed BOOLEAN DEFAULT false,
  
  -- Educational metadata
  content_type VARCHAR(50), -- lecture, assignment, reading, supplementary
  educational_level VARCHAR(20), -- beginner, intermediate, advanced
  learning_objectives TEXT[],
  copyright_info JSONB, -- Copyright and licensing information
  
  -- Audit and compliance
  uploaded_by UUID REFERENCES users(id),
  approved_by UUID REFERENCES users(id), -- For content requiring approval
  approval_status VARCHAR(20) DEFAULT 'pending', -- pending, approved, rejected
  last_accessed TIMESTAMP,
  access_count INTEGER DEFAULT 0,
  
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  deleted_at TIMESTAMP, -- Soft delete for compliance
  
  -- Constraints
  UNIQUE (course_id, file_hash), -- Prevent duplicate files per course
  CHECK (file_size > 0 AND file_size <= 52428800) -- Max 50MB
);

-- REQUIRED: File access audit log
CREATE TABLE material_access_log (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  material_id UUID REFERENCES course_materials(id),
  user_id UUID REFERENCES users(id),
  access_type VARCHAR(20) NOT NULL, -- view, download, preview
  ip_address INET,
  user_agent TEXT,
  success BOOLEAN DEFAULT true,
  error_message TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- REQUIRED: Storage quota tracking
CREATE TABLE storage_quotas (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  course_id UUID REFERENCES courses(id) UNIQUE,
  allocated_bytes BIGINT DEFAULT 838860800, -- ~800MB per course
  used_bytes BIGINT DEFAULT 0,
  file_count INTEGER DEFAULT 0,
  last_cleanup TIMESTAMP,
  quota_exceeded_notified TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

---

#### üîí **Enhanced Security Implementation Required**

**1. Comprehensive File Upload Security**
```javascript
// REQUIRED: Multi-layer file upload security
const secureFileUpload = {
  preUploadValidation: {
    clientSideChecks: {
      fileTypeValidation: 'Check file extension and MIME type',
      fileSizeValidation: 'Validate against dynamic storage limits',
      nameValidation: 'Prevent malicious filenames',
      contentPrecheck: 'Basic content validation before upload'
    },
    
    serverSideValidation: {
      mimeTypeVerification: 'Verify MIME type matches file content',
      fileHeaderAnalysis: 'Analyze file headers for authenticity',
      sizeValidation: 'Server-side size limit enforcement',
      quotaValidation: 'Check course storage quota before upload'
    }
  },
  
  uploadProcessing: {
    virusScanning: {
      scanningService: 'Integrate with ClamAV or similar service',
      quarantineProcess: 'Hold suspicious files in quarantine',
      scanResults: 'Store scan results and handle infected files',
      automaticCleanup: 'Auto-delete infected files after notification'
    },
    
    fileProcessing: {
      metadataStripping: 'Remove potentially malicious metadata',
      contentSanitization: 'Sanitize document content where possible',
      compressionSecurity: 'Validate compressed file contents',
      formatConversion: 'Convert to safer formats when appropriate'
    }
  },
  
  postUploadSecurity: {
    accessControlSetup: 'Configure proper access permissions',
    encryptionAtRest: 'Encrypt sensitive educational materials',
    backupCreation: 'Create secure backups of uploaded materials',
    auditLogEntry: 'Log all upload activities for compliance'
  }
};
```

**2. Advanced Access Control System**
```javascript
// REQUIRED: Sophisticated material access control
const materialAccessControl = {
  authenticationLayer: {
    userAuthentication: 'Verify user identity for all material access',
    sessionValidation: 'Validate active session for file operations',
    tokenAuthentication: 'Secure token-based access for downloads',
    multiFactorAuth: 'MFA for sensitive material access (admin)'
  },
  
  authorizationLayer: {
    courseEnrollment: {
      enrollmentVerification: 'Verify active enrollment for material access',
      roleBasedAccess: 'Different access levels for students/TAs/lecturers',
      temporalAccess: 'Time-based access (during semester only)',
      prerequisiteCheck: 'Verify prerequisite completion for advanced materials'
    },
    
    materialLevelSecurity: {
      visibilityControl: 'Honor material visibility settings',
      downloadPermissions: 'Separate view and download permissions',
      offlineAccess: 'Control offline material access',
      printingRestrictions: 'Restrict printing of sensitive materials'
    }
  },
  
  auditingLayer: {
    accessLogging: 'Log all material access attempts',
    downloadTracking: 'Track material downloads for analytics',
    suspiciousActivity: 'Detect and alert on unusual access patterns',
    complianceReporting: 'Generate access reports for compliance'
  }
};
```

---

#### üîç **Implementation Improvements Required**

**1. Enhanced Error Handling & Recovery**
```javascript
// REQUIRED: Comprehensive error handling
const fileManagementErrorHandling = {
  uploadErrors: {
    networkFailures: {
      retryMechanism: 'Automatic retry with exponential backoff',
      resumableUploads: 'Support for resuming interrupted uploads',
      offlineMode: 'Queue uploads when offline',
      userNotification: 'Clear status updates during retry attempts'
    },
    
    validationFailures: {
      fileTypeErrors: 'Clear guidance on allowed file types',
      sizeExceededErrors: 'Suggestions for file compression',
      quotaExceededErrors: 'Storage management recommendations',
      securityRejections: 'Explanation of security policy violations'
    },
    
    storageErrors: {
      quotaManagement: 'Automated cleanup suggestions',
      storageFailures: 'Fallback storage strategies',
      corruptionDetection: 'File integrity verification',
      recoveryProcedures: 'Data recovery from backups'
    }
  },
  
  accessErrors: {
    permissionDenied: 'Clear explanation of access requirements',
    expiredTokens: 'Automatic token refresh mechanisms',
    unavailableFiles: 'Alternative access methods',
    systemMaintenance: 'Graceful degradation during maintenance'
  }
};
```

**2. Performance Optimization Enhancements**
```javascript
// REQUIRED: Advanced performance strategies
const performanceOptimizations = {
  uploadOptimization: {
    chunkedUploads: 'Break large files into chunks for reliability',
    parallelUploads: 'Multiple file upload support',
    compressionOptimization: 'Intelligent compression based on file type',
    deduplication: 'Eliminate duplicate file uploads across courses'
  },
  
  accessOptimization: {
    contentDelivery: {
      cdnIntegration: 'Leverage Supabase CDN for faster delivery',
      cachingStrategy: 'Intelligent caching of frequently accessed materials',
      compressionDelivery: 'Serve compressed versions when appropriate',
      adaptiveQuality: 'Serve different quality based on connection speed'
    },
    
    previewGeneration: {
      thumbnailCreation: 'Generate thumbnails for visual materials',
      documentPreviews: 'Create previews for documents',
      videoThumbnails: 'Extract video thumbnails for quick preview',
      lazyLoading: 'Load previews on demand'
    }
  },
  
  storageOptimization: {
    automaticCleanup: 'Remove orphaned and expired files',
    compressionScheduling: 'Background compression of old files',
    archivalStrategies: 'Move old materials to cheaper storage',
    usageAnalytics: 'Track material usage for optimization decisions'
  }
};
```

---

#### üìä **Quality Metrics Assessment**

| Aspect | Current Score | Required Score | Critical Gaps |
|--------|---------------|----------------|---------------|
| **File Security** | 3/10 | 9/10 | No virus scanning, malware protection |
| **Access Control** | 4/10 | 9/10 | Basic enrollment check, needs granular control |
| **Storage Management** | 9/10 | 9/10 | Excellent free tier optimization |
| **Upload Security** | 2/10 | 9/10 | No file content validation, header checking |
| **Educational Compliance** | 2/10 | 8/10 | No FERPA compliance, copyright protection |
| **Error Handling** | 5/10 | 8/10 | Basic error handling, needs recovery mechanisms |
| **Performance Design** | 8/10 | 8/10 | Good caching strategy, could enhance CDN usage |
| **Audit & Monitoring** | 3/10 | 9/10 | Basic logging, needs comprehensive audit trail |

**Overall Security Score: 4.5/10** - **CRITICAL SECURITY GAPS**

---

#### üéØ **CRITICAL Action Items - Must Implement**

**BLOCKER ISSUES:**
1. **Implement Virus Scanning** - Mandatory for file uploads in educational environment
2. **Add File Header Validation** - Prevent malicious file disguising
3. **Create Comprehensive Access Control** - Granular permissions for educational materials
4. **Implement Educational Content Protection** - Copyright and FERPA compliance
5. **Add Security Audit Logging** - Track all file access and modifications

**HIGH PRIORITY:**
1. **Enhanced Upload Security** - Multi-layer validation and sanitization
2. **Automatic Content Moderation** - Review materials for inappropriate content
3. **Backup and Recovery System** - Protect educational materials from loss
4. **Storage Security** - Encryption at rest for sensitive materials

**MEDIUM PRIORITY:**
1. **Performance Monitoring** - Track file access and upload performance
2. **Advanced Analytics** - Material usage analytics for educators
3. **Integration with Learning Systems** - Connect with assignment and grading systems
4. **Mobile Optimization** - Enhanced mobile file management experience

---

#### üõ°Ô∏è **Educational Security Compliance**

```javascript
// REQUIRED: Educational file management compliance
const educationalCompliance = {
  ferpaCompliance: {
    studentDataProtection: 'Ensure materials don\'t inadvertently expose student data',
    accessLogging: 'Maintain detailed logs of educational record access',
    parentalRights: 'Support parental access to student materials',
    dataRetention: 'Implement retention policies for educational materials'
  },
  
  copyrightCompliance: {
    fairUseGuidelines: 'Provide guidance on fair use for educational materials',
    licenseTracking: 'Track and enforce material licensing requirements',
    attributionRequirements: 'Ensure proper attribution for external content',
    takedownProcedures: 'Handle copyright infringement claims'
  },
  
  institutionalPolicies: {
    contentStandards: 'Enforce institutional content standards',
    accessibilityCompliance: 'Ensure materials meet accessibility requirements',
    languageSupport: 'Support for multilingual educational content',
    qualityAssurance: 'Review processes for educational material quality'
  }
};
```

---

#### üìù **Final Assessment & Recommendations**

**CRITICAL FINDING:** While this story demonstrates **exceptional free tier engineering**, it has fundamental security vulnerabilities that could expose the educational institution to malware, copyright violations, and compliance failures.

**MAJOR SECURITY CONCERNS:**
- **No Malware Protection** - File uploads lack virus scanning and security validation
- **Insufficient Access Control** - Basic enrollment checking insufficient for educational materials
- **Missing Content Protection** - No copyright or intellectual property protection
- **Inadequate Audit Trail** - Cannot track educational material access for compliance

**RECOMMENDATION:** **IMMEDIATE SECURITY ENHANCEMENT REQUIRED**

**Implementation Strategy:**
1. **Phase 1 (Security Foundation):** Implement file security scanning and validation
2. **Phase 2 (Access Control):** Build comprehensive educational access control
3. **Phase 3 (Compliance):** Add FERPA and copyright compliance features
4. **Phase 4 (Optimization):** Enhance performance and user experience

**Outstanding Engineering Recognition:**
- **Free Tier Mastery** - Brilliant storage allocation and optimization strategy
- **User Experience Design** - Excellent file organization and management workflow
- **Technical Architecture** - Solid database design and file processing pipeline

---

**QA Status:** üü° **CONDITIONAL APPROVAL - SECURITY ENHANCEMENT REQUIRED**  
**Security Priority:** HIGH - File security critical for educational environment  
**Next Review:** After comprehensive file security implementation
